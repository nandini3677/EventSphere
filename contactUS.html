<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact Us ‚Ä¢ EventSphere</title>
  <meta name="csrf-token" content="{{ csrf_token | default('') }}">
  <style>
    :root {
      --gap: 14px;
      --radius: 14px;
      --maxw: 780px;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
      --primary: linear-gradient(135deg,#6a8cff,#4e6ce9);
      --primary-dark: #4457c8;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body {
      font-family: 'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;
      background: linear-gradient(135deg,#69f3ff,#61e7ff,#ffffff);
      color:#222; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      padding:40px 20px;
    }
    .wrap {
      width:100%; max-width:var(--maxw);
      padding:32px;
      background:#ffffff;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      animation: fadeIn 1s ease;
    }
    h1 {
      margin-bottom:6px;
      font-size:2rem;
      background:var(--primary);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    p.lead {margin-bottom:20px;color:#555;font-size:1rem;}
    form {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:var(--gap);
    }
    .field {position:relative;}
    label {
      font-size:.9rem; color:#555; position:absolute;
      left:14px; top:14px;
      transition:all .3s ease; pointer-events:none;
      background:#fff; padding:0 6px;
    }
    input,textarea,select {
      font:inherit;width:100%;
      padding:16px 14px 14px;
      border:1px solid #dbe0ea;
      border-radius:var(--radius);
      background:#fff;outline:none;
      transition:all .3s ease;
    }
    input:focus,textarea:focus,select:focus {
      border-color:#ff0000;
      box-shadow:0 0 0 4px rgba(106,140,255,.15);
    }
    input:focus+label,
    input:not(:placeholder-shown)+label,
    textarea:focus+label,
    textarea:not(:placeholder-shown)+label {
      top:-8px; left:10px; font-size:.75rem;
      color:#4e6ce9; font-weight:500;
    }
    textarea {min-height:140px;resize:vertical;}
    .span-2 {grid-column:1 / -1;}
    .req{color:#ffffff}
    .actions {display:flex;gap:12px;align-items:center;margin-top:10px;}
    button.primary {
      padding:14px 22px;border:none;border-radius:var(--radius);
      background:var(--primary);color:#fff;cursor:pointer;
      font-weight:500;font-size:1rem;
      transition:.3s ease; position:relative;overflow:hidden;
    }
    button.primary:hover {transform:translateY(-2px);box-shadow:0 6px 16px rgba(0,0,0,.15);}
    button.primary:disabled {opacity:.6;cursor:not-allowed;}
    .note {font-size:.9rem;color:#666}
    .toast {
      position:fixed;right:16px;bottom:16px;
      background:#111;color:#fff;padding:14px 18px;
      border-radius:var(--radius);opacity:0;
      transform:translateY(20px) scale(.9);
      transition:.35s ease;box-shadow:var(--shadow);
    }
    .toast.show {opacity:1;transform:translateY(0) scale(1);}
    .error {border-color:#e43d3d !important;}
    /* Animations */
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(20px);}
      to {opacity:1; transform:translateY(0);}
    }
    @media (max-width:720px){form{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap" role="region" aria-labelledby="contact-heading">
    <h1 id="contact-heading">Contact Us</h1>
    <p class="lead">Have a question about EventSphere or want help planning? We‚Äôll get back within 24‚Äì48 hours.</p>

    <form id="contactForm" novalidate aria-describedby="contact-note">
      <!-- Honeypot -->
      <input type="text" name="website" id="website" class="hp" tabindex="-1" autocomplete="off" style="display:none"/>

      <div class="field">
        <input id="full_name" name="full_name" autocomplete="name" required placeholder=" "/>
        <label for="full_name">Full Name <span class="req">*</span></label>
      </div>

      <div class="field">
        <input id="email" name="email" type="email" autocomplete="email" required placeholder=" "/>
        <label for="email">Email <span class="req">*</span></label>
      </div>

      <div class="field">
        <input id="phone" name="phone" type="tel" inputmode="tel" autocomplete="tel" placeholder=" "/>
        <label for="phone">Phone</label>
      </div>

      <div class="field">
        <input id="subject" name="subject" required placeholder=" "/>
        <label for="subject">Subject <span class="req">*</span></label>
      </div>

      <div class="field span-2">
        <textarea id="message" name="message" required placeholder=" "></textarea>
        <label for="message">Message <span class="req">*</span></label>
      </div>

      <div class="span-2 actions">
        <button id="submitBtn" class="primary" type="submit">Send Message</button>
        <span id="contact-note" class="note">By submitting, you agree to our terms.</span>
      </div>
    </form>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    const form = document.getElementById('contactForm');
    const btn = document.getElementById('submitBtn');
    const toast = document.getElementById('toast');

    function showToast(msg){ 
      toast.textContent = msg; 
      toast.classList.add('show'); 
      setTimeout(()=>toast.classList.remove('show'), 3500); 
    }
    function setLoading(state){ 
      btn.disabled = state; 
      btn.textContent = state ? 'Sending‚Ä¶' : 'Send Message'; 
    }
    function validEmail(v){ return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(v); }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());
      ['full_name','email','subject','message'].forEach(id=>document.getElementById(id).classList.remove('error'));
      let ok = true;
      if(!data.full_name?.trim()){ ok=false; document.getElementById('full_name').classList.add('error'); }
      if(!validEmail(data.email || '')){ ok=false; document.getElementById('email').classList.add('error'); }
      if(!data.subject?.trim()){ ok=false; document.getElementById('subject').classList.add('error'); }
      if(!data.message?.trim()){ ok=false; document.getElementById('message').classList.add('error'); }
      if(!ok){ showToast('Please fill all required fields.'); return; }
      if (data.website) { return; } // bot check
      setLoading(true);
      try {
        const res = await fetch('/api/contact', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const json = await res.json();
        if (res.ok) {
          form.reset();
          showToast('‚úÖ Thanks! Your message has been sent.');
        } else {
          showToast(json?.error || '‚ö†Ô∏è Something went wrong. Please try again.');
        }
      } catch (err) {
        showToast('üåê Network error. Please try again.');
      } finally {
        setLoading(false);
      }
    });
  </script>
</body>
</html>
